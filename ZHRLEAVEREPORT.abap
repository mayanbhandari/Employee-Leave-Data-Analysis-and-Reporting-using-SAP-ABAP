*&---------------------------------------------------------------------*
*& Report  ZHRLEAVEREPORT
*&---------------------------------------------------------------------*

REPORT  ZHRLEAVEREPORT.
TYPE-POOLS: SLIS.
INFOTYPES: 2001.

DATA: BEGIN OF I_PA0001 OCCURS 100,
       WERKS TYPE PERSA,
      END OF I_PA0001.

DATA: BEGIN OF I2_PA0001 OCCURS 100,
       PERSA TYPE PERSA,
       NAME1 TYPE PBTXT,
      END OF I2_PA0001.

DATA: BEGIN OF I3_PA0001 OCCURS 100,
       BTRTL TYPE BTRTL_001P,
       BTEXT TYPE BTRTX,
      END OF I3_PA0001.

DATA: IT_PA0001  TYPE STANDARD TABLE OF PA0001,
      WA_PA0001 LIKE LINE OF IT_PA0001.

TYPES: BEGIN OF TY_FINAL,
        ENAME TYPE PA0001-ENAME,
        PERNR TYPE PA0001-PERNR,
        SUBTY TYPE SUBTY,
        PERSK TYPE PA0001-PERSK,
        LEAVET TYPE STRING,
        ENDDA TYPE PA2006-ENDDA,
        BEGDA TYPE PA2006-BEGDA,
        QUOTA TYPE PA2001-ABWTG,
      END OF TY_FINAL.

DATA: IT_FIELDCAT TYPE SLIS_T_FIELDCAT_ALV,
      WA_FIELDCAT TYPE SLIS_FIELDCAT_ALV,
      L_LAYOUT    TYPE SLIS_LAYOUT_ALV,
      L_PRINT     TYPE  SLIS_PRINT_ALV,
      GT_SORT     TYPE SLIS_T_SORTINFO_ALV,
      WA_SORT     TYPE SLIS_SORTINFO_ALV,
      IT_FILTER   TYPE SLIS_T_FILTER_ALV,
      WA_FILTER   TYPE SLIS_FILTER_ALV,
      L_REPID     LIKE SY-REPID.

DATA: T_HEADER    TYPE SLIS_T_LISTHEADER,
      W_HEADER    TYPE SLIS_LISTHEADER.
DATA: IT_FINAL    TYPE TABLE OF TY_FINAL,
      WA_FINAL    LIKE LINE OF IT_FINAL.
DATA: IT_HEADER   TYPE TABLE OF TY_FINAL,
      WA_HEADER   LIKE LINE OF  IT_HEADER.
DATA: V_DATA      TYPE STRING,
      V_ENAME     TYPE PA0001-ENAME,
      V_PERSK     TYPE PA0001-PERSK,
      LV_LINES    TYPE I,
      PERNR       TYPE PA0001-PERNR.

SELECTION-SCREEN BEGIN OF BLOCK BLOCK WITH FRAME TITLE TEXT-100.
PARAMETER :      S_PERSA TYPE T500P-PERSA ,
                 S_BTRTL TYPE PA0001-BTRTL,
                 S_BEGDA TYPE PA2001-BEGDA OBLIGATORY,
                 S_ENDDA TYPE PA2001-ENDDA OBLIGATORY.
SELECT-OPTIONS : S_PERNR FOR PERNR.
SELECTION-SCREEN END OF BLOCK BLOCK.

AT SELECTION-SCREEN ON S_PERSA.
  PERFORM CHECK_WERKS.

AT SELECTION-SCREEN ON S_BTRTL.
  PERFORM CHECK_BTRTL.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR  S_PERSA.
  PERFORM SHOW_F4_HELP.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR  S_BTRTL.
  PERFORM SHOW_F4_HELP1.

START-OF-SELECTION.

  PERFORM CREATE_FIELD_CATALOG.
  PERFORM DATA_RETRIEVAL.
  PERFORM TOP_OF_PAGE.
  PERFORM DISPLAY_ALV.

* Further code truncated for brevity
